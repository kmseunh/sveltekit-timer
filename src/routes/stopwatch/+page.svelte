<script>
    let milliseconds = 0;
    let seconds = 0;
    let minutes = 0;
    let timer;
    let isRunning = false;
    let isStopped = false;
    let laps = [];

    const startWatch = () => {
        timer = setInterval(() => {
            milliseconds++;
            isRunning = true;
            if (milliseconds === 1000) {
                milliseconds = 0;
                seconds++;
            }
            if (seconds === 60) {
                seconds = 0;
                minutes++;
            }
        }, 1);
        return timer;
    };

    const stopWatch = () => {
        clearInterval(timer);
        isRunning = false;
        isStopped = true;
    };

    const resetWatch = () => {
        clearInterval(timer);
        laps = [];
        milliseconds = 0;
        seconds = 0;
        minutes = 0;
        isStopped = false;
    };

    const labWatch = () => {
        laps = [
            ...laps,
            {
                lapNumber: laps.length + 1,
                time: `${minutes}:${seconds}.${milliseconds}`,
            },
        ];
    };
</script>

<div class="flex items-center justify-center h-screen">
    <div class="bg-rec w-[38rem] h-[54.5rem] rounded-[1.875rem] relative">
        <div
            class="text-btn text-[1.375rem] font-light uppercase relative flex items-center justify-center mt-[5.3125rem]"
        >
            kim’s time
        </div>
        <div
            class="text-[3.4375rem] font-semibold uppercase relative flex items-center justify-center"
        >
            stopwatch
        </div>
        <div class="w-[30.1875rem] h-[7.3125rem]">
            <div
                class="w-[483px] h-[7.3125rem] absolute left-[3.4375rem] top-[14.875rem] rounded-[15px] border-[.0313rem] border-btn"
            ></div>
            <p
                class="absolute left-[3.9375rem] top-[14.0625rem] text-[5.9375rem] font-semibold uppercase"
            >
                {minutes < 10 ? '0' + minutes : minutes}:{seconds < 10
                    ? '0' + seconds
                    : seconds}.{milliseconds < 10
                    ? '00' + milliseconds
                    : milliseconds < 100
                      ? '0' + milliseconds
                      : milliseconds}
            </p>
            <button
                id="lap"
                on:click={labWatch}
                class="absolute left-[5.5rem] top-[25.5625rem]"
            >
                <svg
                    width="96"
                    height="96"
                    viewBox="0 0 96 96"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                >
                    <circle
                        cx="48"
                        cy="48"
                        r="47.5"
                        fill="white"
                        fill-opacity="0.4"
                        stroke="white"
                    />
                    <path
                        d="M61.7988 50.3848H57.8652V42.7031H54.377V50.125H50.5176V32.3496H54.377V39.4375H57.8652V31.793H61.7988V50.3848ZM43.2441 54.9863H57.7168V51.832H61.7988V64.8945H39.1621V51.832H43.2441V54.9863ZM57.7168 61.5547V58.2148H43.2441V61.5547H57.7168ZM47.252 42.8145H38.5312V46.0615C40.7331 46.0244 42.6009 45.9502 44.1348 45.8389C45.6686 45.7275 47.2272 45.5111 48.8105 45.1895L49.1816 48.4922C47.2643 48.8385 45.3841 49.0736 43.541 49.1973C41.7103 49.321 39.4714 49.3828 36.8242 49.3828H34.5234V39.7715H43.2812V36.877H34.4863V33.6113H47.252V42.8145Z"
                        fill="white"
                    />
                </svg></button
            >
            {#if isRunning}
                <button
                    on:click={stopWatch}
                    class="absolute left-[25.5rem] top-[25.5625rem]"
                >
                    <svg
                        width="96"
                        height="96"
                        viewBox="0 0 96 96"
                        fill="none"
                        xmlns="http://www.w3.org/2000/svg"
                    >
                        <circle cx="48" cy="48" r="48" fill="#FF8A00" />
                        <path
                            d="M46.6914 50.4961H33.4062V53.2979C36.4368 53.4958 38.7871 54.1081 40.457 55.1348C42.127 56.1491 42.9681 57.5221 42.9805 59.2539C42.9681 60.528 42.498 61.6165 41.5703 62.5195C40.6426 63.4225 39.3128 64.1029 37.5811 64.5605C35.8493 65.0306 33.7773 65.2656 31.3652 65.2656C28.9284 65.2656 26.8317 65.0306 25.0752 64.5605C23.3311 64.1029 21.9951 63.4225 21.0674 62.5195C20.1396 61.6165 19.6758 60.528 19.6758 59.2539C19.6758 57.5221 20.5169 56.1429 22.1992 55.1162C23.8815 54.0895 26.2565 53.4834 29.3242 53.2979V50.4961H16.1133V47.1562H46.6914V50.4961ZM31.3652 56.3965C28.9036 56.4212 27.0358 56.6748 25.7617 57.1572C24.4876 57.6273 23.8568 58.3262 23.8691 59.2539C23.8568 60.1816 24.4876 60.8929 25.7617 61.3877C27.0482 61.8701 28.916 62.1113 31.3652 62.1113C33.765 62.1113 35.6081 61.8701 36.8945 61.3877C38.1934 60.8929 38.849 60.1816 38.8613 59.2539C38.849 58.3385 38.1995 57.6396 36.9131 57.1572C35.6266 56.6748 33.7773 56.4212 31.3652 56.3965ZM43.9453 36.543H34.2783C34.501 37.4707 35.0824 38.3428 36.0225 39.1592C36.9749 39.9756 38.2367 40.6683 39.8076 41.2373C41.391 41.8063 43.2031 42.1836 45.2441 42.3691L43.7969 45.6348C40.7786 45.3255 38.181 44.6019 36.0039 43.4639C33.8268 42.3258 32.2806 40.9033 31.3652 39.1963C30.4499 40.9033 28.9098 42.332 26.7451 43.4824C24.5928 44.6204 22.0137 45.3379 19.0078 45.6348L17.5977 42.3691C19.5892 42.1836 21.3643 41.8063 22.9229 41.2373C24.4814 40.6683 25.737 39.9756 26.6895 39.1592C27.6419 38.3304 28.2357 37.4583 28.4707 36.543H18.8965V33.2402H43.9453V36.543ZM75.4141 41.1816H80.127V44.5957H75.4141V56.0254H71.2949V31.7559H75.4141V41.1816ZM65.3945 37.8418H54.4473V46.9707H55.1523C58.1706 46.9707 60.6383 46.8965 62.5557 46.748C64.4854 46.5996 66.3841 46.3275 68.252 45.9316L68.6973 49.2715C66.5573 49.6921 64.3555 49.9766 62.0918 50.125C59.8281 50.2734 56.8223 50.3477 53.0742 50.3477H50.3652V34.5391H65.3945V37.8418ZM76.75 64.6348H53.9277V53.4648H58.0469V61.2949H76.75V64.6348Z"
                            fill="white"
                        />
                    </svg>
                </button>
            {:else if isStopped}
                <button
                    on:click={resetWatch}
                    class="absolute left-[25.5rem] top-[25.5625rem]"
                    ><svg
                        width="96"
                        height="96"
                        viewBox="0 0 96 96"
                        fill="none"
                        xmlns="http://www.w3.org/2000/svg"
                    >
                        <circle
                            cx="48"
                            cy="48"
                            r="47.5"
                            fill="white"
                            fill-opacity="0.4"
                            stroke="white"
                        />
                        <path
                            d="M31.8477 61.6074H28.7422V48.1895H26.0176V60.3184H22.9414V35.5918H26.0176V45.4941H28.7422V35.123H31.8477V61.6074ZM17.1113 41.8906C17.1113 44.4004 17.5605 46.6318 18.459 48.585C19.3574 50.5381 20.7441 51.998 22.6191 52.9648L20.7148 55.4551C19.4844 54.8008 18.4443 53.917 17.5947 52.8037C16.7549 51.6904 16.0908 50.3916 15.6025 48.9072C15.1436 50.6064 14.4844 52.0908 13.625 53.3604C12.7754 54.6299 11.7109 55.6406 10.4316 56.3926L8.43945 53.9023C10.3145 52.8379 11.7012 51.2559 12.5996 49.1562C13.498 47.0469 13.9473 44.625 13.9473 41.8906V40.6309H9.23047V38.0234H21.4473V40.6309H17.1113V41.8906ZM56.9844 48.6875H53.7324V41.9785H48.459V39.3711H53.7324V35.123H56.9844V48.6875ZM56.9844 56.6855H42.7754V58.707H57.834V61.2852H39.582V54.2539H53.7617V52.3789H39.5527V49.8301H56.9844V56.6855ZM44.416 38.1113C44.416 39.2148 44.6553 40.2695 45.1338 41.2754C45.6123 42.2812 46.3203 43.1748 47.2578 43.9561C48.1953 44.7275 49.3281 45.3184 50.6562 45.7285L48.9277 48.248C47.5117 47.7695 46.2861 47.0859 45.251 46.1973C44.2158 45.2988 43.4053 44.2393 42.8193 43.0186C42.2236 44.3955 41.3789 45.5869 40.2852 46.5928C39.2012 47.5889 37.8926 48.3359 36.3594 48.834L34.6602 46.2266C36.0469 45.8066 37.2236 45.1914 38.1904 44.3809C39.167 43.5605 39.8994 42.6133 40.3877 41.5391C40.8857 40.4648 41.1348 39.3223 41.1348 38.1113V36.002H44.416V38.1113ZM82.9121 50.8555H79.6602V44.3809H75.1484V41.7148H79.6602V35.123H82.9121V50.8555ZM73.9473 51.5293C75.8125 51.5293 77.4238 51.7295 78.7812 52.1299C80.1484 52.5205 81.1934 53.0967 81.916 53.8584C82.6387 54.6104 83 55.5137 83 56.5684C83 57.623 82.6387 58.5264 81.916 59.2783C81.1934 60.04 80.1484 60.6162 78.7812 61.0068C77.4238 61.4072 75.8125 61.6074 73.9473 61.6074C72.0918 61.6074 70.4854 61.4072 69.1279 61.0068C67.7705 60.6162 66.7305 60.04 66.0078 59.2783C65.2949 58.5264 64.9434 57.623 64.9531 56.5684C64.9434 55.5137 65.2949 54.6104 66.0078 53.8584C66.7305 53.0967 67.7705 52.5205 69.1279 52.1299C70.4854 51.7295 72.0918 51.5293 73.9473 51.5293ZM73.9473 54.0195C72.0918 54.0195 70.666 54.2393 69.6699 54.6787C68.6738 55.1084 68.1758 55.7383 68.1758 56.5684C68.1758 57.3887 68.6738 58.0137 69.6699 58.4434C70.666 58.873 72.0918 59.0879 73.9473 59.0879C75.8027 59.0879 77.2334 58.873 78.2393 58.4434C79.2451 58.0137 79.748 57.3887 79.748 56.5684C79.748 55.7383 79.2451 55.1084 78.2393 54.6787C77.2334 54.2393 75.8027 54.0195 73.9473 54.0195ZM70.4609 39.6641C70.4609 40.7578 70.7002 41.8223 71.1787 42.8574C71.6572 43.8828 72.3652 44.8057 73.3027 45.626C74.2402 46.4365 75.373 47.0664 76.7012 47.5156L75.0605 50.0938C73.625 49.6055 72.3799 48.8877 71.3252 47.9404C70.2803 46.9834 69.46 45.8701 68.8643 44.6006C68.2686 46.0361 67.4189 47.291 66.3154 48.3652C65.2119 49.4297 63.8887 50.2402 62.3457 50.7969L60.6465 48.2188C62.0234 47.75 63.2002 47.0713 64.1768 46.1826C65.1533 45.2842 65.8906 44.2734 66.3887 43.1504C66.8965 42.0273 67.1504 40.875 67.1504 39.6934V39.4883H61.6426V36.8516H75.9395V39.4883H70.4609V39.6641Z"
                            fill="white"
                        />
                    </svg>
                </button>
            {:else}
                <button
                    id="start"
                    on:click={startWatch}
                    class="absolute left-[25.5rem] top-[25.5625rem]"
                    ><svg
                        width="96"
                        height="96"
                        viewBox="0 0 96 96"
                        fill="none"
                        xmlns="http://www.w3.org/2000/svg"
                    >
                        <circle cx="48" cy="48" r="47.5" stroke="#FF8A00" />
                        <path
                            d="M28.8047 39.8086C28.7923 41.8743 29.1325 43.8844 29.8252 45.8389C30.5179 47.7933 31.5199 49.5312 32.8311 51.0527C34.1423 52.5742 35.6823 53.7122 37.4512 54.4668L35.002 57.7695C33.1094 56.8913 31.458 55.611 30.0479 53.9287C28.6501 52.2464 27.5553 50.2858 26.7637 48.0469C25.972 50.4714 24.8525 52.599 23.4053 54.4297C21.9704 56.248 20.2572 57.6211 18.2656 58.5488L15.7422 55.0977C17.5605 54.3184 19.1377 53.1432 20.4736 51.5723C21.8219 49.9889 22.8486 48.1768 23.5537 46.1357C24.2588 44.0824 24.6113 41.9733 24.6113 39.8086V34.4648H28.8047V39.8086ZM44.0195 65.3398H39.8633V31.7559H44.0195V65.3398ZM60.9785 37.582C60.9785 38.9798 61.2754 40.3343 61.8691 41.6455C62.4753 42.9443 63.3721 44.1071 64.5596 45.1338C65.7594 46.1605 67.2129 46.9583 68.9199 47.5273L66.8418 50.7188C65.0111 50.1126 63.4277 49.2158 62.0918 48.0283C60.7559 46.8285 59.7106 45.4245 58.9561 43.8164C58.2015 45.5729 57.1253 47.1006 55.7275 48.3994C54.3421 49.6859 52.6908 50.6569 50.7734 51.3125L48.584 48.1211C50.3405 47.5397 51.8372 46.7109 53.0742 45.6348C54.3112 44.5462 55.2451 43.3092 55.876 41.9238C56.5068 40.526 56.8223 39.0788 56.8223 37.582V37.1738H49.7344V33.8711H67.9551V37.1738H60.9785V37.582ZM75.4141 40.1426H80.0898V43.5938H75.4141V51.9805H71.2949V31.7559H75.4141V40.1426ZM75.4141 65.3027H71.2949V56.8418H53.0742V53.5391H75.4141V65.3027Z"
                            fill="#FF8A00"
                        />
                    </svg>
                </button>
            {/if}

            <div id="line" class="absolute left-[3.6875rem] top-[35.8125rem]">
                <svg
                    width="474"
                    height="1"
                    viewBox="0 0 474 1"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                >
                    <line y1="0.5" x2="474" y2="0.5" stroke="#FF8A00" />
                </svg>
            </div>
            <div
                class="absolute left-[3.6875rem] top-[36.875rem] w-[29.625rem] flex flex-col-reverse"
            >
                {#each laps.slice().reverse() as lap}
                    <div class="flex text-[1.75rem] justify-between">
                        <span>랩{lap.lapNumber}</span>
                        <span>{lap.time}</span>
                    </div>
                {/each}
            </div>
        </div>
    </div>
</div>
